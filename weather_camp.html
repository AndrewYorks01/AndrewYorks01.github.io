<!DOCTYPE html>
<meta charset="UTF-8">
<html>

<head>
    <title>Camping Weather</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
</head>

<style>

    .menu{
        background-color: lightgray;
    }

    a{
      color: black;
        text-decoration: none;
        background-color: none;
    }

    button{
    font-family: "Open Sans";
    font-size: 16px;
    padding: 12px 24px;
    }

    body{
      font-family: "Open Sans";
    }

    table,th,td {
    border : 1px solid black;
    border-collapse: collapse;
    }

    th,td {
    padding: 5px;
    }

    .dropbtn{
      background-color: lightgrey;
      color: black;
      font-family: "Open Sans";
      font-size: 16px;
      padding: 16px;
      border: none;
      cursor: pointer;
    }

    .dropdown{
      position: relative;
      display: inline-block;
    }

    .dropdown-content{
      display: none;
      position: absolute;
      background-color: #f9f9f9;
      min-width: 60px;
      overflow: auto;
      box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
      z-index: 1;
    }

    .dropdown-content a{
      color: black;
      padding: 12px;
      text-decoration: none;
      display: block;
      cursor: pointer;
    }

    .show {display: block;}

    .monthhead{
      text-align: center;
    }


</style>

<body>
  <div class = "menu">
    <p><a href="index.html">Home</a> · <a href="jsoncoaster.html">List</a> · <a href="coastergame.html">Game</a></p>
  </div>

  <h1>Camping Weather</h1>
  <p>Select a month from the drop-down menu to see weather conditions for various areas in that month.</p>

  <div class="dropdown">
    <button onclick="myFunction()" class="dropbtn">Month</button>
    <div id="myDropdown" class="dropdown-content">
      <a onclick="showMonth(1)">January</a>
      <a onclick="showMonth(2)">February</a>
      <a onclick="showMonth(3)">March</a>
      <a onclick="showMonth(4)">April</a>
      <a onclick="showMonth(5)">May</a>
      <a onclick="showMonth(6)">June</a>
      <a onclick="showMonth(7)">July</a>
      <a onclick="showMonth(8)">August</a>
      <a onclick="showMonth(9)">September</a>
      <a onclick="showMonth(10)">October</a>
      <a onclick="showMonth(11)">November</a>
      <a onclick="showMonth(12)">December</a>
    </div>
  </div>

  <p id="monthhead"></p>
  <table id="demo"></table>

</body>

<script>

base_high = 65.9;
base_low = 46.7;
base_rain = 4.84;

function myFunction(){
  document.getElementById("myDropdown").classList.toggle("show");
}

// Close dropdown menu when user clicks outside
window.onclick = function(event){
  if (!event.target.matches('.dropbtn')){
    var dropdowns = document.getElementsByClassName("dropdown-content");
    var i;
    for (i = 0; i < dropdowns.length; i++) {
      var openDropdown = dropdowns[i];
      if (openDropdown.classList.contains('show')){
        openDropdown.classList.remove('show');
      }
    }
  }
}

// Next step: create a function that loads a table with the weather data.
function showMonth(month){

const xmlhttp = new XMLHttpRequest();
xmlhttp.onload = function() {
const obj = JSON.parse(this.responseText);
const array = obj.parks;

  // The array entries[] will be loaded with the associated data based on the month the user inputs.
  // Any existing data will be deleted before the array is loaded.

  const entries = [];
  var heading;

  if (month == 1){
    heading = "<h2>January</h2>";
    entries.length = 0;
    for (let x of array){
      let myObject = { name: x.name, state: x.state, station: x.station, max: x.janmax, min: x.janmin, rain: x.janrain, score: 0};
      entries.push(myObject);      
    }
  }

  else if (month == 2){
    heading = "<h2>February</h2>";
    entries.length = 0;
    for (let x of array){
      let myObject = { name: x.name, state: x.state, station: x.station, max: x.febmax, min: x.febmin, rain: x.febrain, score: 0};
      entries.push(myObject);      
    }
  }

  else if (month == 3){
    heading = "<h2>March</h2>";
    entries.length = 0;
    for (let x of array){
      let myObject = { name: x.name, state: x.state, station: x.station, max: x.marmax, min: x.marmin, rain: x.marrain, score: 0};
      entries.push(myObject);      
    }
  }

  else if (month == 4){
    heading = "<h2>April</h2>";
    entries.length = 0;
    for (let x of array){
      let myObject = { name: x.name, state: x.state, station: x.station, max: x.aprmax, min: x.aprmin, rain: x.aprrain, score: 0};
      entries.push(myObject);      
    }
  }

  else if (month == 5){
    heading = "<h2>May</h2>";
    entries.length = 0;
    for (let x of array){
      let myObject = { name: x.name, state: x.state, station: x.station, max: x.maymax, min: x.maymin, rain: x.mayrain, score: 0};
      entries.push(myObject);      
    }
  }

  else if (month == 6){
    heading = "<h2>June</h2>";
    entries.length = 0;
    for (let x of array){
      let myObject = { name: x.name, state: x.state, station: x.station, max: x.junmax, min: x.junmin, rain: x.junrain, score: 0};
      entries.push(myObject);      
    }
  }

  else if (month == 7){
    heading = "<h2>July</h2>";
    entries.length = 0;
    for (let x of array){
      let myObject = { name: x.name, state: x.state, station: x.station, max: x.julmax, min: x.julmin, rain: x.julrain, score: 0};
      entries.push(myObject);      
    }
  }

  else if (month == 8){
    heading = "<h2>August</h2>";
    entries.length = 0;
    for (let x of array){
      let myObject = { name: x.name, state: x.state, station: x.station, max: x.augmax, min: x.augmin, rain: x.augrain, score: 0};
      entries.push(myObject);      
    }
  }

  else if (month == 9){
    heading = "<h2>September</h2>";
    entries.length = 0;
    for (let x of array){
      let myObject = { name: x.name, state: x.state, station: x.station, max: x.sepmax, min: x.sepmin, rain: x.seprain, score: 0};
      entries.push(myObject);      
    }
  }

  else if (month == 10){
    heading = "<h2>October</h2>";
    entries.length = 0;
    for (let x of array){
      let myObject = { name: x.name, state: x.state, station: x.station, max: x.octmax, min: x.octmin, rain: x.octrain, score: 0};
      entries.push(myObject);      
    }
  }

  else if (month == 11){
    heading = "<h2>November</h2>";
    entries.length = 0;
    for (let x of array){
      let myObject = { name: x.name, state: x.state, station: x.station, max: x.novmax, min: x.novmin, rain: x.novrain, score: 0};
      entries.push(myObject);      
    }
  }

  else if (month == 12){
    heading = "<h2>December</h2>";
    entries.length = 0;
    for (let x of array){
      let myObject = { name: x.name, state: x.state, station: x.station, max: x.decmax, min: x.decmin, rain: x.decrain, score: 0};
      entries.push(myObject);      
    }
  }

  for (let x of entries){
    let hi_range = Math.abs(x.max - base_high);
    let lo_range = Math.abs(x.min - base_low);

    // high
    if (hi_range <= 5)
      x.score += 2;
    else if ((hi_range > 5) && (hi_range <= 10))
      x.score += 1;
    else
      x.score += 0;

    // low
    if (lo_range <= 5)
      x.score += 2;
    else if ((lo_range > 5) && (lo_range <= 10))
      x.score += 1;
    else
      x.score += 0;

    // rain
    if (x.rain <= 5)
      x.score += 2;
    else if ( (x.rain > 5) && (x.rain <= 10) )
      x.score += 1;
    else
      x.score += 0;

    // wind and dew point will be added later
    if (x.max < 30)
      x.score = 0;
    if (x.max > 90)
      x.score = 0;
  }

  var i;
  var table="<tr><th>Park</th><th>Station</th><th>Max</th><th>Min</th><th>Rain</th></tr>";

    for (i = 0; i <array.length; i++) { 
    table += "<tr><td>" +
    entries[i].name + ", " + entries[i].state +
    "</td><td>" + 
    entries[i].station +
    "</td><td>" + 
    entries[i].max +
    "</td><td>" +
    entries[i].min +
    "</td><td>" +  
    entries[i].rain +
    "</td></tr>";

    document.getElementById("monthhead").innerHTML = heading;
    document.getElementById("demo").innerHTML = table;
 }

}
xmlhttp.open("GET", "parkweather.txt");
xmlhttp.send();  
}

</script>

</html>