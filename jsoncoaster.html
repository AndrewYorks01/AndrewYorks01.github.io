<!DOCTYPE html>
<html>

<head>
    <title>Coaster List</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
  </head>
  
  
  <style>
    button{
      font-family: "Open Sans";
      font-size: 16px;
      padding: 12px 24px;
    }
    body{
      font-family: "Open Sans";
    }
  table,th,td {
    border : 1px solid black;
    border-collapse: collapse;
  }
  th,td {
    padding: 5px;
  }
  </style>

<body>

<h1>Coaster List</h1>
<p>Click on a coaster to display information about it. You can also sort the data.</p>
<p id="showCoaster"></p>
<button type="button" onclick="sortByName()">Name</button>
<button type="button" onclick="sortByPark()">Park</button>
<button type="button" onclick="sortByManufacturer()">Manufacturer</button>
<table id="demo"></table>

<script>
const xmlhttp = new XMLHttpRequest();
xmlhttp.onload = function() {
 const obj = JSON.parse(this.responseText);
 const array = obj.coasters;

 // Sort the coasters alphabetically.
 array.sort((a, b) => {
    const nameComp = a.name.localeCompare(b.name);
    if (nameComp !== 0){
        return nameComp;
    }
    return a.park.localeCompare(b.park);
 })

 // Create the table.
 var i;
 var table="<tr><th>Name</th><th>Park</th><th>Manufacturer</th></tr>";

 for (i = 0; i <array.length; i++) { 
    table += "<tr onClick='displayCoaster(" + i + ")'><td>" +
    array[i].name +
    "</td><td>" + 
    array[i].park +
    "</td><td>" + 
    array[i].manufacturer +
    "</td></tr>";
 }

 document.getElementById("demo").innerHTML = table;
}
xmlhttp.open("GET", "coasterdata.txt");
xmlhttp.send();
</script>

<script>

  // Display more info about a coaster. This only works if the list is sorted alphabetically by the coaster's name.
    function displayCoaster(i){
      const request = new XMLHttpRequest();
      request.onload = function() {
        const obj = JSON.parse(this.responseText);
        const array = obj.coasters;
        
         // Sort the coasters alphabetically.
        array.sort((a, b) => {
        const nameComp = a.name.localeCompare(b.name);
        if (nameComp !== 0){
        return nameComp;
        }
        return a.park.localeCompare(b.park);
      })

      let dispText = "<b>" + array[i].name + "</b>" + " at " + array[i].park;
      if (array[i].manufacturer === "in-house")
        dispText += "<br>This coaster was built in-house by the park themselves.";
      else
        dispText += "<br>This coaster was built by " + array[i].manufacturer + ".";
      if (array[i].credit !== "-")
        dispText += "<br>This was my coaster #" + array[i].credit + ".";
      document.getElementById("showCoaster").innerHTML = dispText;
      }

      request.open("GET", "coasterdata.txt");
      request.send();   
  }

  function sortByPark(){
    const xmlhttp = new XMLHttpRequest();
    xmlhttp.onload = function() {
    const obj = JSON.parse(this.responseText);
    const array = obj.coasters;

 // Sort the coasters alphabetically.
 array.sort((a, b) => {
    const nameComp = a.park.localeCompare(b.park);
    if (nameComp !== 0){
        return nameComp;
    }
    return a.name.localeCompare(b.name);
 })

 // Create the table.
 var i;
 var table="<tr><th>Name</th><th>Park</th><th>Manufacturer</th></tr>";

 for (i = 0; i <array.length; i++) { 
    table += "<tr><td>" +
    array[i].name +
    "</td><td>" + 
    array[i].park +
    "</td><td>" + 
    array[i].manufacturer +
    "</td></tr>";
 }

 document.getElementById("demo").innerHTML = table;
}
xmlhttp.open("GET", "coasterdata.txt");
xmlhttp.send();    
  }

  function sortByName(){
    const xmlhttp = new XMLHttpRequest();
    xmlhttp.onload = function() {
    const obj = JSON.parse(this.responseText);
    const array = obj.coasters;

 // Sort the coasters alphabetically.
 array.sort((a, b) => {
    const nameComp = a.name.localeCompare(b.name);
    if (nameComp !== 0){
        return nameComp;
    }
    return a.park.localeCompare(b.park);
 })

 // Create the table.
 var i;
 var table="<tr><th>Name</th><th>Park</th><th>Manufacturer</th></tr>";

 for (i = 0; i <array.length; i++) { 
    table += "<tr onClick='displayCoaster(" + i + ")'><td>" +
    array[i].name +
    "</td><td>" + 
    array[i].park +
    "</td><td>" + 
    array[i].manufacturer +
    "</td></tr>";
 }

 document.getElementById("demo").innerHTML = table;
}
xmlhttp.open("GET", "coasterdata.txt");
xmlhttp.send();    
  }

  function sortByManufacturer(){
    const xmlhttp = new XMLHttpRequest();
    xmlhttp.onload = function() {
    const obj = JSON.parse(this.responseText);
    const array = obj.coasters;

 // Sort the coasters alphabetically.
 array.sort((a, b) => {
    const nameComp = a.manufacturer.localeCompare(b.manufacturer);
    if (nameComp !== 0){
        return nameComp;
    }
    return a.name.localeCompare(b.name);
 })

 // Create the table.
 var i;
 var table="<tr><th>Name</th><th>Park</th><th>Manufacturer</th></tr>";

 for (i = 0; i <array.length; i++) { 
    table += "<tr><td>" +
    array[i].name +
    "</td><td>" + 
    array[i].park +
    "</td><td>" + 
    array[i].manufacturer +
    "</td></tr>";
 }

 document.getElementById("demo").innerHTML = table;
}
xmlhttp.open("GET", "coasterdata.txt");
xmlhttp.send();    
  }
</script>




</body>
</html>